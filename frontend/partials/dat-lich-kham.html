<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Đặt lịch khám</title>
  <link rel="stylesheet" href="../css/style-common.css" />
  <link rel="stylesheet" href="../css/style-dat-lich-kham.css" />
  
  <style>
    /* Layout chia 2 cột */
    .booking-grid {
        display: grid;
        grid-template-columns: 1.5fr 1fr;
        gap: 30px;
        max-width: 1200px;
        margin: 40px auto;
        padding: 0 20px;
    }
    
    /* Form Container */
    .booking-form-container {
        background: #fff;
        padding: 30px;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    }
    
    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; margin-bottom: 8px; font-weight: 600; }
    .form-control { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; }
    .btn-submit { width: 100%; padding: 12px; background: #0093E9; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; font-weight: bold; }
    
    /* Doctor Preview Card (Cột phải) */
    .doctor-preview-card {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 12px;
        text-align: center;
        border: 2px dashed #cbd5e1;
        height: fit-content;
        position: sticky;
        top: 20px;
    }
    .doc-img { width: 150px; height: 150px; object-fit: cover; border-radius: 50%; margin-bottom: 15px; border: 4px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    .doc-name { color: #0093E9; margin-bottom: 5px; }
    .doc-spec { color: #666; font-weight: 600; margin-bottom: 10px; }
    .doc-error { color: red; font-weight: bold; display: none; }

    /* Modal Đăng ký Bệnh nhân */
    .modal-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.6);
        display: none; justify-content: center; align-items: center; z-index: 1000;
    }
    .modal-content {
        background: white; padding: 30px; border-radius: 12px; width: 90%; max-width: 600px;
        max-height: 90vh; overflow-y: auto;
    }
    .modal-title { margin-top: 0; color: #0093E9; text-align: center; }
    
    @media (max-width: 768px) {
        .booking-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div data-include="header.html"></div>

  <main class="booking-page">
    <section class="booking-grid" id="booking-grid">
      
      <div class="booking-form-container">
        <h2 style="margin-bottom: 20px; color: #333;">Thông tin đặt lịch</h2>
        <form id="bookingForm">
            <div class="form-group">
                <label for="bookingCCCD">Số CCCD / CMND (Bắt buộc) <span style="color:red">*</span></label>
                <input type="number" id="bookingCCCD" class="form-control" placeholder="Nhập 12 số CCCD..." required>
            </div>

            <div class="form-group">
                <label for="bookingDocId">Mã số Bác sĩ (ID) <span style="color:red">*</span></label>
                <input type="number" id="bookingDocId" class="form-control" placeholder="Nhập ID bác sĩ..." required>
                <small style="color: #666;">Nhập ID để xem thông tin bác sĩ bên cạnh.</small>
            </div>

            <div class="form-group">
                <label for="bookingTime">Thời gian khám mong muốn <span style="color:red">*</span></label>
                <input type="datetime-local" id="bookingTime" class="form-control" required>
            </div>

            <div class="form-group">
                <label for="bookingNotes">Ghi chú / Triệu chứng</label>
                <textarea id="bookingNotes" class="form-control" rows="3" placeholder="Mô tả sơ qua về tình trạng sức khỏe..."></textarea>
            </div>

            <input type="hidden" id="bookingDeptId">

            <button type="submit" class="btn-submit" id="btnBookAppointment">
                Xác nhận Đặt lịch
            </button>
        </form>
      </div>

      <div class="doctor-preview-card" id="doctorPreview">
         <div id="docInfoContent" style="display: none;">
             <img src="http://localhost:8080/uploads/hospital.png" alt="Doctor" class="doc-img" id="previewImg">
             <h3 class="doc-name" id="previewName"></h3>
             <div class="doc-spec" id="previewSpec"></div>
             <p id="previewExp"></p>
             <p id="previewRating" style="color: #f59e0b; font-weight: bold;"></p>
         </div>
         
         <div id="docEmptyState">
             <img src="http://localhost:8080/uploads/logo.png" style="width: 80px; opacity: 0.5; margin-bottom: 10px;">
             <p>Vui lòng nhập <strong>ID Bác sĩ</strong> để xem thông tin.</p>
         </div>

         <div id="docErrorState" class="doc-error">
             <i class="fa-solid fa-triangle-exclamation"></i>
             <p>Không tìm thấy bác sĩ với ID này!</p>
             <p>Vui lòng nhập lại.</p>
         </div>
      </div>

    </section>
  </main>

  <div class="modal-overlay" id="registerModal">
      <div class="modal-content">
          <h2 class="modal-title">Đăng ký hồ sơ bệnh nhân</h2>
          <p style="text-align: center; margin-bottom: 20px; color: #666;">
              CCCD này chưa tồn tại trong hệ thống. Vui lòng tạo hồ sơ mới.
          </p>
          <form id="registerForm">
              <input type="hidden" id="regCCCD"> <div class="form-group">
                  <label>Họ và tên <span style="color:red">*</span></label>
                  <input type="text" id="regFullName" class="form-control" required>
              </div>
              
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                  <div class="form-group">
                      <label>Ngày sinh</label>
                      <input type="date" id="regDob" class="form-control">
                  </div>
                  <div class="form-group">
                      <label>Giới tính</label>
                      <select id="regGender" class="form-control">
                          <option value="MALE">Nam</option>
                          <option value="FEMALE">Nữ</option>
                          <option value="OTHER">Khác</option>
                      </select>
                  </div>
              </div>

              <div class="form-group">
                  <label>Số điện thoại <span style="color:red">*</span></label>
                  <input type="tel" id="regPhone" class="form-control" required>
              </div>

              <div class="form-group">
                  <label>Địa chỉ</label>
                  <input type="text" id="regAddress" class="form-control">
              </div>

              <div style="display: flex; gap: 10px; margin-top: 20px;">
                  <button type="button" class="btn-submit" style="background: #ccc; color: #333;" onclick="closeModal()">Hủy</button>
                  <button type="submit" class="btn-submit">Lưu hồ sơ & Tiếp tục</button>
              </div>
          </form>
      </div>
  </div>

  <div data-include="footer.html"></div>

  <script src="../js/app-dat-lich-kham.js"></script>
  <script src="../partials/include.js"></script>
</body>
</html>